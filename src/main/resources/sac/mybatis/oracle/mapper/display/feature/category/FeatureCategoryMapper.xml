<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="FeatureCategory">
    <!-- 영화 추천/1000원관 방송 카테고리별 추천 상품 조회 -->
    <select id="selectFeatureVodList" parameterType="FeatureCategoryVodSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectFeatureVodList, 조준일, 2014-02-10 */
               B.TENANT_ID
             , B.MENU_ID
             , B.PROD_ID
             , B.TOP_MENU_ID
             , B.CONTENTS_TYPE_CD
             , B.TOTAL_COUNT
	      FROM (SELECT A.*
	                 , COUNT(*) OVER () AS TOTAL_COUNT
                     , ROW_NUMBER() OVER(ORDER BY A.EXPO_ORD_ALWAYS_YN DESC, A.EXPO_ORD, A.EXPO_ORD_SUB, A.PROD_NM) AS RNUM
	             FROM (SELECT A.TENANT_ID
	                        , D.MENU_ID
	                        , A.PROD_ID
	                        , D.TOP_MENU_ID
	                        , E.META_CLSF_CD
	                        , 'PD002501' AS CONTENTS_TYPE_CD
	                        , A.EXPO_ORD_ALWAYS_YN
	                        , A.EXPO_ORD
	                        , A.EXPO_ORD_SUB
	                        , E.REG_DT
	                        , H.PROD_NM
	                        , ROW_NUMBER() OVER(PARTITION BY A.PROD_ID ORDER BY E.REG_DT DESC) AS RN
	                     FROM (SELECT LP.*
	                             FROM TB_DP_LIST_PROD LP  /* 채널 */
	                                , TB_DP_LIST LT
	                            WHERE LP.TENANT_ID = #{tenantId}   /* 테넌트ID */
	                              AND LP.LIST_ID = #{listId}       /* ADM000000008 : 운영자추천 멀티미디어 */
	                              <if test='filteredBy == "recommend"'>
	                              AND LP.ETC_CD = 'DP004801'       /* DP004801 : 영화 */
	                              </if>
	                              <if test='filteredBy == "movie1000"'>
	                              AND LP.ETC_CD = 'DP004807'       /* DP004807 : 1000원관 */
	                              </if>
	                               <if test='filteredBy == "westernDrama"'>
	                              AND LP.ETC_CD = 'DP004803'       /* 미드/외화 */  
	                              </if>
	                              <if test='filteredBy == "drama"'>
	                              AND LP.ETC_CD = 'DP004804'       /* 드라마 */
	                              </if>
	                              <if test='filteredBy == "entertainmentFun"'>
	                              AND LP.ETC_CD = 'DP004805'       /* 연예/오락 */
	                              </if>
	                              <if test='filteredBy == "animationKids"'>
	                              AND LP.ETC_CD = 'DP004806'       /* 애니/키즈 */
	                              </if>
	                              <if test='filteredBy == "cable"'>
	                              AND LP.ETC_CD = 'DP004811'       /* 케이블 */
	                              </if>
	                              <if test='filteredBy == "special"'>
	                              AND LP.ETC_CD = 'DP004812'       /* 스페셜 */
	                              </if>
	                              AND LP.EXPO_YN = 'Y'             /* Y : 노출 (노출여부) */
	                              AND TO_CHAR(LP.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
	                              AND SYSDATE BETWEEN EXPO_START_DT AND EXPO_END_DT
	                              AND LP.TENANT_ID = LT.TENANT_ID
	                              AND LP.LIST_ID = LT.LIST_ID
	                              AND LT.EXPO_YN = 'Y'
	                          ) A
	                        , TB_DP_PROD_RSHP B
	                        , TB_DP_MENU_CATEGORY_PROD_MAPG C
	                        , TB_DP_MENU_CATEGORY D
	                        , TB_DP_PROD E
	                        , TB_DP_TENANT_PROD F
	                        , TB_DP_SPRT_DEVICE G
	                        , TB_DP_PROD_DESC H  /* 채널 */
	                    WHERE A.PROD_ID = B.PROD_ID
	                      AND B.PROD_RSHP_CD = 'DP010802'
	                      AND A.MENU_ID = C.MENU_ID
	                      AND B.PART_PROD_ID = C.PROD_ID
	                      AND C.USE_YN = 'Y'
	                      AND C.MENU_ID = D.MENU_ID
	                      AND D.USE_YN = 'Y'
	                      AND D.TOP_MENU_ID = #{topMenuId}
	                      AND C.PROD_ID = E.PROD_ID
	                      AND E.SVC_GRP_CD = 'DP000203'
	                      AND E.CONTENTS_TYPE_CD = 'PD002502'
	                      <if test='prodGradeCd != null and prodGradeCd != ""'>
	                      AND E.PROD_GRD_CD IN
	                          <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
	                          #{prodGradeCd}  
	                          </foreach> /* 상품등급코드 */
	                      </if>
	                      AND E.PROD_ID = F.PROD_ID
	                      AND A.TENANT_ID = F.TENANT_ID
	                      AND F.PROD_STATUS_CD = 'PD000403'
	                      AND F.EXPO_YN = 'Y'
	                      AND F.PROD_ID = G.PROD_ID
	                      AND (G.DEVICE_MODEL_CD = #{deviceModelCd} OR G.DEVICE_MODEL_CD = 'android_standard2') /* 단말기 모델 코드 */
	                      AND (CASE WHEN (SELECT VIDEO_DRM_SPRT_YN 
	                                        FROM TB_CM_DEVICE 
	                                       WHERE DEVICE_MODEL_CD = #{deviceModelCd} )  = 'N' 
	                                         AND NVL(E.DRM_YN, 'N') = 'Y' 
	                                THEN 'NOT SUPPORT'
	                                ELSE 'SUPPORT'
	                            END) = 'SUPPORT'   /* DRM 미지원 단말이고 에피소드 상품이 DRM 상품일 경우 노출 안함 */
	                      AND B.PROD_ID = H.PROD_ID
	                      AND H.LANG_CD = #{langCd}
	                  ) A
	            WHERE RN = 1
	          ) B
	    WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
	    ORDER BY RNUM
    </select>
    
    <!-- 영화/방송 카테고리 신규 상품 조회 -->
    <select id="selectFeatureNewVodist" parameterType="FeatureCategoryVodSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectFeatureNewVodist, 조준일, 2014-02-10 */
               B.TENANT_ID
             , B.MENU_ID
             , B.PROD_ID
             , B.TOP_MENU_ID
             , B.CONTENTS_TYPE_CD
             , B.TOTAL_COUNT
          FROM (SELECT A.*
                     , COUNT(*) OVER () AS TOTAL_COUNT
                     --,ROW_NUMBER() OVER(ORDER BY A.EXPO_ORD_ALWAYS_YN DESC, A.EXPO_ORD, A.EXPO_ORD_SUB) AS RNUM
                     <if test='orderedBy == "recent"'>
                     , ROW_NUMBER() OVER(ORDER BY A.REG_DT DESC, A.PROD_NM) AS RNUM  /* 최신순 */
                     </if>
                     <if test='orderedBy == "download"'>
                     , ROW_NUMBER() OVER(ORDER BY A.PRCHS_CNT, A.REG_DT DESC, A.PROD_NM) AS RNUM  /* 다운로드순 */
                     </if>
                     <if test='orderedBy == "popular"'>
                     , ROW_NUMBER() OVER(ORDER BY A.AVG_EVLU_SCORE, A.REG_DT DESC, A.PROD_NM) AS RNUM  /* 평점순 */
                     </if>
                     <if test='orderedBy != "recent" and orderedBy != "download" and orderedBy != "popular"'>
                     , ROW_NUMBER() OVER(ORDER BY A.REG_DT DESC, A.PROD_NM) AS RNUM  /* 최신순 */
                     </if>
                 FROM (SELECT A.TENANT_ID
                            , D.MENU_ID
                            , A.PROD_ID
                            , D.TOP_MENU_ID
                            , E.META_CLSF_CD
                            , 'PD002501' AS CONTENTS_TYPE_CD
                            , A.EXPO_ORD_ALWAYS_YN
                            , A.EXPO_ORD
                            , A.EXPO_ORD_SUB
                            , E.REG_DT
                            , H.PRCHS_CNT
                            , H.AVG_EVLU_SCORE
                            , I.PROD_NM
                            , ROW_NUMBER() OVER(PARTITION BY A.PROD_ID ORDER BY E.REG_DT DESC) AS RN
                         FROM (SELECT LP.*
                                 FROM TB_DP_LIST_PROD LP  /* 채널 */
                                    , TB_DP_LIST LT
                                WHERE LP.TENANT_ID = #{tenantId}   /* 테넌트ID */
                                  AND LP.LIST_ID = #{listId}       /* TGR000000002 : 운영자신규 멀티미디어 */
                                  AND LP.EXPO_YN = 'Y'             /* Y : 노출 (노출여부) */
                                  AND TO_CHAR(LP.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
                                  AND SYSDATE BETWEEN EXPO_START_DT AND EXPO_END_DT
                                  AND LP.TENANT_ID = LT.TENANT_ID
                                  AND LP.LIST_ID = LT.LIST_ID
                                  AND LT.EXPO_YN = 'Y'
                              ) A
                            , TB_DP_PROD_RSHP B
                            , TB_DP_MENU_CATEGORY_PROD_MAPG C
                            , TB_DP_MENU_CATEGORY D
                            , TB_DP_PROD E  /* 에피소드 */
                            , TB_DP_TENANT_PROD F
                            , TB_DP_SPRT_DEVICE G
                            , TB_DP_TENANT_PROD_STATS H  /* 채널 */
                            , TB_DP_PROD_DESC I  /* 채널 */
                        WHERE A.PROD_ID = B.PROD_ID
                          AND B.PROD_RSHP_CD = 'DP010802'
                          AND A.MENU_ID = C.MENU_ID
                          AND B.PART_PROD_ID = C.PROD_ID
                          AND C.USE_YN = 'Y'
                          AND C.MENU_ID = D.MENU_ID
                          AND D.USE_YN = 'Y'
                          AND D.TOP_MENU_ID = #{topMenuId}
                          <if test='menuId != null and menuId != ""'>
                          AND D.MENU_ID = #{menuId}
                          </if>
                          AND C.PROD_ID = E.PROD_ID
                          AND E.SVC_GRP_CD = 'DP000203'
                          AND E.CONTENTS_TYPE_CD = 'PD002502'
                          <if test='prodGradeCd != null and prodGradeCd != ""'>
                          AND E.PROD_GRD_CD IN
                              <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                              #{prodGradeCd}  
                              </foreach> /* 상품등급코드 */
                          </if>
                          AND E.PROD_ID = F.PROD_ID
                          AND A.TENANT_ID = F.TENANT_ID
                          AND F.PROD_STATUS_CD = 'PD000403'
                          AND F.EXPO_YN = 'Y'
                          AND F.PROD_ID = G.PROD_ID
                          AND (G.DEVICE_MODEL_CD = #{deviceModelCd} OR G.DEVICE_MODEL_CD = 'android_standard2') /* 단말기 모델 코드 */
                          AND (CASE WHEN (SELECT VIDEO_DRM_SPRT_YN 
                                            FROM TB_CM_DEVICE 
                                           WHERE DEVICE_MODEL_CD = #{deviceModelCd} )  = 'N' 
                                             AND NVL(E.DRM_YN, 'N') = 'Y' 
                                    THEN 'NOT SUPPORT'
                                    ELSE 'SUPPORT'
                                END) = 'SUPPORT'   /* DRM 미지원 단말이고 에피소드 상품이 DRM 상품일 경우 노출 안함 */
                                
                          AND A.PROD_ID = H.PROD_ID(+)
                          AND A.TENANT_ID = H.TENANT_ID(+)
                          AND B.PROD_ID = I.PROD_ID
                          AND I.LANG_CD = #{langCd}
                      ) A
                WHERE RN = 1
              ) B
        WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
        ORDER BY RNUM
    </select>
    
    <!-- 방송 최신UP 상품 조회(더미) -->
    <select id="selectFeatureNewUpTvList" parameterType="FeatureCategoryVodSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectFeatureNewUpTvList, 조준일, 2014-02-10 */
               B.TENANT_ID
             , B.MENU_ID
             , B.PROD_ID
             , B.TOP_MENU_ID
             , B.CONTENTS_TYPE_CD
             , B.TOTAL_COUNT
          FROM (SELECT A.*
                     , COUNT(*) OVER () AS TOTAL_COUNT
                     --,ROW_NUMBER() OVER(ORDER BY A.EXPO_ORD_ALWAYS_YN DESC, A.EXPO_ORD, A.EXPO_ORD_SUB) AS RNUM
                     , ROW_NUMBER() OVER(ORDER BY A.REG_DT DESC, A.PROD_NM) AS RNUM  /* 최신순 */
                  FROM (SELECT A.TENANT_ID
                            , D.MENU_ID
                            , A.PROD_ID
                            , D.TOP_MENU_ID
                            , E.META_CLSF_CD
                            , 'PD002501' AS CONTENTS_TYPE_CD
                            , A.EXPO_ORD_ALWAYS_YN
                            , A.EXPO_ORD
                            , A.EXPO_ORD_SUB
                            , E.REG_DT
                            , H.PROD_NM
                            , ROW_NUMBER() OVER(PARTITION BY A.PROD_ID ORDER BY E.REG_DT DESC) AS RN
                         FROM (SELECT LP.*
                                 FROM TB_DP_LIST_PROD LP  /* 채널 */
                                    , TB_DP_LIST LT
                                WHERE LP.TENANT_ID = #{tenantId}   /* 테넌트ID */
                                  AND LP.LIST_ID = 'ADM000000008' --listId       /* TGR000000002 : 운영자신규 멀티미디어 */
                                  AND LP.EXPO_YN = 'Y'             /* Y : 노출 (노출여부) */
                                  AND TO_CHAR(LP.STD_DT, 'YYYYMMDDHH24MISS') = '20130101000000' --stdDt
                                  AND SYSDATE BETWEEN EXPO_START_DT AND EXPO_END_DT
                                  AND LP.MENU_ID LIKE 'DP18%'
                                  AND LP.TENANT_ID = LT.TENANT_ID
                                  AND LP.LIST_ID = LT.LIST_ID
                                  AND LT.EXPO_YN = 'Y'
                                  AND LP.PROD_ID NOT IN (SELECT PROD_ID
                                                           FROM (SELECT LP.PROD_ID
                                                                      , ROW_NUMBER() OVER(PARTITION BY LP.ETC_CD ORDER BY LP.EXPO_ORD_ALWAYS_YN DESC, LP.EXPO_ORD, LP.EXPO_ORD_SUB, PD.PROD_NM) AS NO
                                                                     FROM TB_DP_LIST_PROD LP  /* 채널 */
                                                                        , TB_DP_LIST LT
                                                                        , TB_DP_TENANT_PROD TP
                                                                        , TB_DP_PROD_DESC PD
                                                                    WHERE LP.TENANT_ID = #{tenantId}   /* 테넌트ID */
                                                                      AND LP.LIST_ID = 'ADM000000008'  /* ADM000000008 : 운영자추천 멀티미디어 */
                                                                      AND LP.ETC_CD IN ('DP004803', 'DP004804', 'DP004805', 'DP004806', 'DP004811', 'DP004812')
                                                                      AND LP.EXPO_YN = 'Y'  /* Y : 노출 (노출여부) */
                                                                      AND TO_CHAR(LP.STD_DT, 'YYYYMMDDHH24MISS') = #{subStdDt}
                                                                      AND SYSDATE BETWEEN EXPO_START_DT AND EXPO_END_DT
                                                                      AND LP.TENANT_ID = LT.TENANT_ID
                                                                      AND LP.LIST_ID = LT.LIST_ID
                                                                      AND LT.EXPO_YN = 'Y'
                                                                      AND LP.PROD_ID = TP.PROD_ID
                                                                      AND LP.TENANT_ID = TP.TENANT_ID
                                                                      AND TP.PROD_STATUS_CD = 'PD000403'
                                                                      AND TP.EXPO_YN = 'Y'
                                                                      AND LP.PROD_ID = PD.PROD_ID
                                                                      AND PD.LANG_CD = #{langCd}
                                                                )
                                                          WHERE NO <![CDATA[<=]]> 4
                                                        )  /* 방송 카테고리별 추천 제외 */
                              ) A
                            , TB_DP_PROD_RSHP B
                            , TB_DP_MENU_CATEGORY_PROD_MAPG C
                            , TB_DP_MENU_CATEGORY D
                            , TB_DP_PROD E  /* 에피소드 */
                            , TB_DP_TENANT_PROD F
                            , TB_DP_SPRT_DEVICE G
                            , TB_DP_PROD_DESC H  /* 채널 */
                            , UV_TB_DP_MULTIMDA_PROD I
                        WHERE A.PROD_ID = B.PROD_ID
                          AND B.PROD_RSHP_CD = 'DP010802'
                          AND A.MENU_ID = C.MENU_ID
                          AND B.PART_PROD_ID = C.PROD_ID
                          AND C.USE_YN = 'Y'
                          AND C.MENU_ID = D.MENU_ID
                          AND D.USE_YN = 'Y'
                          AND D.TOP_MENU_ID = 'DP18'
                          AND C.PROD_ID = E.PROD_ID
                          AND E.SVC_GRP_CD = 'DP000203'
                          AND E.CONTENTS_TYPE_CD = 'PD002502'
                          <if test='prodGradeCd != null and prodGradeCd != ""'>
                          AND E.PROD_GRD_CD IN
                              <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                              #{prodGradeCd}  
                              </foreach> /* 상품등급코드 */
                          </if>
                          AND E.PROD_ID = F.PROD_ID
                          AND A.TENANT_ID = F.TENANT_ID
                          AND F.PROD_STATUS_CD = 'PD000403'
                          AND F.EXPO_YN = 'Y'
                          AND F.PROD_ID = G.PROD_ID
                          AND (G.DEVICE_MODEL_CD = #{deviceModelCd} OR G.DEVICE_MODEL_CD = 'android_standard2') /* 단말기 모델 코드 */
                          AND (CASE WHEN (SELECT VIDEO_DRM_SPRT_YN 
                                            FROM TB_CM_DEVICE 
                                           WHERE DEVICE_MODEL_CD = #{deviceModelCd} )  = 'N' 
                                             AND NVL(E.DRM_YN, 'N') = 'Y' 
                                    THEN 'NOT SUPPORT'
                                    ELSE 'SUPPORT'
                                END) = 'SUPPORT'   /* DRM 미지원 단말이고 에피소드 상품이 DRM 상품일 경우 노출 안함 */
                          AND B.PROD_ID = H.PROD_ID
                          AND H.LANG_CD = #{langCd}
                          AND H.PROD_ID = I.PROD_ID
                          <if test='filteredBy == "mbc"'>
                          AND I.BRDC_COMP_CD = 'DP004601'  /* mbc */
                          </if>
                          <if test='filteredBy == "kbs"'>
                          AND I.BRDC_COMP_CD = 'DP004602'  /* kbs */
                          </if>
                          <if test='filteredBy == "sbs"'>
                          AND I.BRDC_COMP_CD = 'DP004603'  /* sbs */
                          </if>
                      ) A
                WHERE RN = 1
              ) B
        WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
        ORDER BY RNUM
    </select>
    
    <!--운영자 추천 이북/코믹 더미 조회-->
    <select id="selectCategoryEpubListDummy" parameterType="FeatureCategoryEpubSacReq" resultType="FeatureCategoryEpub">
       /* FeatureCategoryMapper.xml, selectCategoryEpubListDummy, SAC : 서영배 , 2014-01-03 */
       SELECT
            PROD.*
            , NVL(ST.DWLD_CNT, 0) DWLD_CNT
            , NVL(ST.PRCHS_CNT, 0) PRCHS_CNT
        FROM (
            SELECT 
                COUNT(*) OVER () AS TOTAL_COUNT
                , LP.TENANT_ID
                , MN.UP_MENU_ID AS TOP_MENU_ID
                , (SELECT MENU_NM FROM TB_DP_MENU_CATEGORY_DESC WHERE MENU_ID = MN.UP_MENU_ID AND LANG_CD = 'ko') TOP_MENU_NM
                , MN.MENU_ID
                , (SELECT MENU_NM FROM TB_DP_MENU_CATEGORY_DESC WHERE MENU_ID = MN.MENU_ID AND LANG_CD = 'ko') MENU_NM
                , DP.PROD_ID
                , DP.META_CLSF_CD
                , AP.BOOK_CLSF_CD
                , AP.CHAPTER
                , CONCAT( PS.PROD_NM
                    , NVL2( AP.BOOK_CLSF_CD
                       , ' '||CONCAT( AP.CHAPTER
                                    , DECODE( AP.BOOK_CLSF_CD
                                            , 'DP004301', '권'
                                            , 'DP004302', '회'
                                            , 'DP004303', '호' ) )
                       , NULL ) ) AS PROD_NM
                , PS.PROD_BASE_DESC
                , PR.PROD_AMT
                , PR.PROD_NET_AMT
                , PS.ARTIST1_NM
                , PS.ARTIST2_NM
                , PS.ARTIST3_NM
                , DECODE( DP.PROD_GRD_CD
                        , 'PD004401', 0
                        , 'PD004402', 1
                        , 'PD004403', 2
                        , 'PD004404', 4 ) AS PROD_GRD_CD
                , AP.CHNL_COMP_NM
                , AP.ISSUE_DAY
                , AP.BOOK_PAGE_CNT
                , NVL(AP.EPSD_CNT, 0) EPSD_CNT
                , NVL(AP.STRM_EPSD_CNT, 0) STRM_EPSD_CNT
                , AP.CAPTION_YN
                , ( CASE WHEN DP.META_CLSF_CD = 'CT20' THEN 'serial' END ) AS BOOK_TYPE
                , ( CASE WHEN DP.META_CLSF_CD = 'CT20' THEN ( AP.EPSD_CNT + AP.STRM_EPSD_CNT ) END ) AS BOOK_COUNT
                , ( CASE WHEN AP.EPSD_CNT > 0 THEN 'store' END ) AS SUPPORT_STORE
                , ( CASE WHEN AP.STRM_EPSD_CNT > 0 THEN 'play' END ) AS SUPPORT_PLAY
                , ( CASE WHEN DP.META_CLSF_CD = 'CT20' THEN DECODE( AP.CAPTION_YN, 'Y', 'completed', 'continue' ) END ) AS BOOK_STATUS
                , SC.FILE_SIZE AS FILE_SIZE
                , PI.FILE_PATH || PI.FILE_NM AS FILE_PATH
            FROM 
                TB_DP_LIST_PROD LP,
                TB_DP_PROD DP,
                TB_DP_TENANT_PROD_PRICE PR,
                TB_DP_MENU_CATEGORY_PROD_MAPG MP, 
                UV_TB_DP_MULTIMDA_PROD AP,
                TB_DP_TENANT_PROD TP, 
                TB_DP_PROD_DESC PS,
                TB_DP_SUB_CONTENTS SC,
                TB_DP_PROD_IMG PI,
                TB_DP_MENU_CATEGORY MN
            WHERE LP.LIST_ID LIKE 'ADM%'
            AND DP.PROD_ID = LP.PROD_ID
            AND DP.PROD_ID = PR.PROD_ID
            AND MP.PROD_ID = DP.PROD_ID
            AND DP.PROD_ID = AP.PROD_ID
            AND DP.PROD_ID = TP.PROD_ID
            AND DP.PROD_ID = PS.PROD_ID
            AND DP.PROD_ID = SC.PROD_ID
            AND DP.PROD_ID = PI.PROD_ID
            AND MN.MENU_ID = MP.MENU_ID
            AND PI.IMG_CD = 'DP000109'
            AND ROWNUM <![CDATA[<=]]> #{count}
            AND DP.META_CLSF_CD IN ('CT20','CT19')
        ) PROD LEFT OUTER JOIN TB_DP_TENANT_PROD_STATS ST
        ON PROD.PROD_ID = ST.PROD_ID
        AND PROD.TENANT_ID = ST.TENANT_ID
    </select>    
    
    <!--운영자 추천 앱상품 조회-->
    <select id="selectTopMenuAppListByRecent" parameterType="FeatureCategoryAppSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectTopMenuAppListByRecent, SAC : 조준일 , 2014-02-04 */
               B.TENANT_ID
             , B.MENU_ID
             , B.PROD_ID
             , B.TOTAL_COUNT
          FROM (SELECT A.*
                    , COUNT(*) OVER () AS TOTAL_COUNT
                    , ROW_NUMBER() OVER(ORDER BY A.EXPO_ORD_ALWAYS_YN DESC, A.EXPO_ORD, A.EXPO_ORD_SUB) AS RNUM
                 FROM (SELECT A.TENANT_ID
                             , B.MENU_ID
                             , B.PROD_ID
                             , B.EXPO_ORD_ALWAYS_YN
                             , B.EXPO_ORD
                             , B.EXPO_ORD_SUB
                             , ROW_NUMBER() OVER ( PARTITION BY E.SELLER_MBR_NO ORDER BY B.UPD_DT DESC ) AS RN
                          FROM TB_DP_LIST A
                             , TB_DP_LIST_PROD B
                             , TB_DP_MENU_CATEGORY_PROD_MAPG C
                             , TB_DP_MENU_CATEGORY D
                             , TB_DP_PROD E
                             , TB_DP_SUB_CONTENTS F
                             , TB_DP_SPRT_DEVICE G
                             , TB_CM_DEVICE H
                             , TB_DP_TENANT_PROD I
                             , TB_DP_APP_PROD J
                         WHERE A.LIST_ID = B.LIST_ID
                           AND A.TENANT_ID = B.TENANT_ID
                           AND B.LIST_ID = #{listId}
                           AND A.TENANT_ID = #{tenantId}
                           AND A.EXPO_YN = 'Y'
                           AND B.EXPO_YN = 'Y'
                           AND TO_CHAR(B.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
                           AND SYSDATE BETWEEN B.EXPO_START_DT AND B.EXPO_END_DT
                           AND B.PROD_ID = C.PROD_ID
                           AND B.MENU_ID = C.MENU_ID
                           AND C.USE_YN = 'Y'
                           AND C.MENU_ID = D.MENU_ID
                           AND D.USE_YN = 'Y'
                           <if test='menuId != null and menuId != ""'>
                           AND D.TOP_MENU_ID = #{menuId}
                           </if>
                           AND C.PROD_ID = E.PROD_ID
                           AND D.TOP_MENU_ID = E.TOP_MENU_ID
                           <if test='prodGradeCd != null and prodGradeCd != ""'>
                           AND E.PROD_GRD_CD IN
                              <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                              #{prodGradeCd}          
                              </foreach> /* 상품등급코드 */
                           </if>
                           <if test='prodCharge == "Y"'>
                           AND E.PROD_CHRG_YN = 'Y'  /* 유료 */
                           </if>
                           <if test='prodCharge == "N"'>
                           AND E.PROD_CHRG_YN = 'N'  /* 무료 */
                           </if>  
                           AND E.PROD_ID = F.PROD_ID
                           AND F.PROD_ID = G.PROD_ID
                           AND F.SUB_CONTENTS_ID = G.SUB_CONTENTS_ID
                           AND G.DEVICE_MODEL_CD = H.DEVICE_MODEL_CD
                           AND G.DEVICE_MODEL_CD = #{deviceModelCd}
                           AND B.PROD_ID = I.PROD_ID
                           AND I.TENANT_ID = #{tenantId}
                           AND I.EXPO_YN = 'Y'
                           AND I.PROD_STATUS_CD = 'PD000403'
                           AND I.PROD_ID = J.PROD_ID
                      ) A 
                WHERE A.RN <![CDATA[<=]]> 2
               ) B
         WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
         ORDER BY RNUM
    </select>
    
    <!--운영자 추천 앱상품 조회 메인-->
    <select id="selectTopMenuAppList" parameterType="FeatureCategoryAppSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectTopMenuAppList, SAC : 조준일 , 2014-02-04 */
               A.TENANT_ID
             , A.MENU_ID
             , A.PROD_ID
             , A.TOTAL_COUNT
          FROM (SELECT A.TENANT_ID
                     , B.MENU_ID
                     , B.PROD_ID
                     , COUNT(*) OVER () AS TOTAL_COUNT
                     , ROW_NUMBER() OVER(ORDER BY B.EXPO_ORD_ALWAYS_YN DESC, B.EXPO_ORD, B.EXPO_ORD_SUB) AS RNUM
                  FROM TB_DP_LIST A
                     , TB_DP_LIST_PROD B
                     , TB_DP_MENU_CATEGORY_PROD_MAPG C
                     , TB_DP_MENU_CATEGORY D
                     , TB_DP_PROD E
                     , TB_DP_SUB_CONTENTS F
                     , TB_DP_SPRT_DEVICE G
                     , TB_CM_DEVICE H
                     , TB_DP_TENANT_PROD I
                     , TB_DP_APP_PROD J
                 WHERE A.LIST_ID = B.LIST_ID
                   AND A.TENANT_ID = B.TENANT_ID
                   AND B.LIST_ID = #{listId}
                   AND A.TENANT_ID = #{tenantId}
                   AND A.EXPO_YN = 'Y'
                   AND B.EXPO_YN = 'Y'
                   AND TO_CHAR(B.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
                   AND SYSDATE BETWEEN B.EXPO_START_DT AND B.EXPO_END_DT
                   AND B.PROD_ID = C.PROD_ID
                   AND B.MENU_ID = C.MENU_ID
                   AND C.USE_YN = 'Y'
                   AND C.MENU_ID = D.MENU_ID
                   AND D.USE_YN = 'Y'
                   <if test='menuId != null and menuId != ""'>
                   AND D.TOP_MENU_ID = #{menuId}
                   </if>
                   AND C.PROD_ID = E.PROD_ID
                   AND D.TOP_MENU_ID = E.TOP_MENU_ID
                   <if test='prodGradeCd != null and prodGradeCd != ""'>
                   AND E.PROD_GRD_CD IN
                       <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                   #{prodGradeCd}          
                       </foreach> /* 상품등급코드 */
                   </if>
                   <if test='prodCharge == "Y"'>
                   AND E.PROD_CHRG_YN = 'Y'  /* 유료 */
                   </if>
                   <if test='prodCharge == "N"'>
                   AND E.PROD_CHRG_YN = 'N'  /* 무료 */
                   </if>  
                   AND E.PROD_ID = F.PROD_ID
                   AND F.PROD_ID = G.PROD_ID
                   AND F.SUB_CONTENTS_ID = G.SUB_CONTENTS_ID
                   AND G.DEVICE_MODEL_CD = H.DEVICE_MODEL_CD
                   AND G.DEVICE_MODEL_CD = #{deviceModelCd}
                   AND B.PROD_ID = I.PROD_ID
                   AND I.TENANT_ID = #{tenantId}
                   AND I.EXPO_YN = 'Y'
                   AND I.PROD_STATUS_CD = 'PD000403'
                   AND I.PROD_ID = J.PROD_ID
               ) A 
         WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
         ORDER BY RNUM
    </select>
    
    <!--운영자 추천 앱상품 조회 메인-->
    <select id="selectSubMenuAppList" parameterType="FeatureCategoryAppSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectSubMenuAppList, SAC : 조준일 , 2014-02-04 */
               A.TENANT_ID
             , A.MENU_ID
             , A.PROD_ID
             , A.TOTAL_COUNT
          FROM (SELECT A.TENANT_ID
                     , B.MENU_ID
                     , B.PROD_ID
                     , COUNT(*) OVER () AS TOTAL_COUNT
                     , ROW_NUMBER() OVER(ORDER BY B.EXPO_ORD_ALWAYS_YN DESC, B.EXPO_ORD, B.EXPO_ORD_SUB) AS RNUM
                  FROM TB_DP_LIST A
                     , TB_DP_LIST_PROD B
                     , TB_DP_MENU_CATEGORY_PROD_MAPG C
                     , TB_DP_MENU_CATEGORY D
                     , TB_DP_PROD E
                     , TB_DP_SUB_CONTENTS F
                     , TB_DP_SPRT_DEVICE G
                     , TB_CM_DEVICE H
                     , TB_DP_TENANT_PROD I
                     , TB_DP_APP_PROD J
                 WHERE A.LIST_ID = B.LIST_ID
                   AND A.TENANT_ID = B.TENANT_ID
                   AND B.LIST_ID = #{listId}
                   AND A.TENANT_ID = #{tenantId}
                   AND A.EXPO_YN = 'Y'
                   AND B.EXPO_YN = 'Y'
                   AND TO_CHAR(B.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
                   AND SYSDATE BETWEEN B.EXPO_START_DT AND B.EXPO_END_DT
                   AND B.PROD_ID = C.PROD_ID
                   AND B.MENU_ID = C.MENU_ID
                   AND C.USE_YN = 'Y'
                   AND C.MENU_ID = D.MENU_ID
                   AND D.USE_YN = 'Y'
                   <if test='menuId != null and menuId != ""'>
                   AND D.MENU_ID = #{menuId}
                   </if>
                   AND C.PROD_ID = E.PROD_ID
                   AND D.TOP_MENU_ID = E.TOP_MENU_ID
                   <if test='prodGradeCd != null and prodGradeCd != ""'>
                   AND E.PROD_GRD_CD IN
                       <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                   #{prodGradeCd}          
                       </foreach> /* 상품등급코드 */
                   </if>
                   <if test='prodCharge == "Y"'>
                   AND E.PROD_CHRG_YN = 'Y'  /* 유료 */
                   </if>
                   <if test='prodCharge == "N"'>
                   AND E.PROD_CHRG_YN = 'N'  /* 무료 */
                   </if>  
                   AND E.PROD_ID = F.PROD_ID
                   AND F.PROD_ID = G.PROD_ID
                   AND F.SUB_CONTENTS_ID = G.SUB_CONTENTS_ID
                   AND G.DEVICE_MODEL_CD = H.DEVICE_MODEL_CD
                   AND G.DEVICE_MODEL_CD = #{deviceModelCd}
                   AND B.PROD_ID = I.PROD_ID
                   AND I.TENANT_ID = #{tenantId}
                   AND I.EXPO_YN = 'Y'
                   AND I.PROD_STATUS_CD = 'PD000403'
                   AND I.PROD_ID = J.PROD_ID
               ) A 
         WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
         ORDER BY RNUM
    </select>
    
    <!--운영자 추천 앱상품 조회-->
    <select id="selectCategoryAppListDummy" parameterType="FeatureCategoryAppSacReq" resultType="FeatureCategoryApp">
       /* FeatureCategoryMapper.xml, selectCategoryAppListDummy, SAC : 서영배 , 2014-01-03 */
        SELECT
            PROD.*
            , NVL(ST.DWLD_CNT, 0) DWLD_CNT
            , NVL(ST.PRCHS_CNT, 0) PRCHS_CNT
        FROM (
            SELECT 
                COUNT(*) OVER () AS TOTAL_COUNT
                , LP.TENANT_ID
                , MN.UP_MENU_ID AS TOP_MENU_ID
                , (SELECT MENU_NM FROM TB_DP_MENU_CATEGORY_DESC WHERE MENU_ID = MN.UP_MENU_ID AND LANG_CD = 'ko') TOP_MENU_NM
                , MN.MENU_ID
                , (SELECT MENU_NM FROM TB_DP_MENU_CATEGORY_DESC WHERE MENU_ID = MN.MENU_ID AND LANG_CD = 'ko') MENU_NM
                , DP.PROD_ID
                , AP.AID
                , PS.PROD_NM
                , PS.PROD_BASE_DESC
                , PR.PROD_AMT
                , DECODE( DP.PROD_GRD_CD
                        , 'PD004401', 0
                        , 'PD004402', 1
                        , 'PD004403', 2
                        , 'PD004404', 4 ) AS PROD_GRD_CD
                , DECODE( AP.PART_PARENT_CLSF_CD, 'PD012301', 'iab', NULL ) AS PART_PARENT_CLSF_CD
                , DECODE( DP.DRM_YN, 'Y', 'drm', NULL ) AS DRM_YN
                , SC.APK_PKG_NM
                , SC.APK_VER
                , SC.FILE_SIZE AS APK_FILE_SIZE
                , AP.VER_MAJOR||'.'||AP.VER_MINOR AS PROD_VER
                , PI.FILE_PATH || PI.FILE_NM AS FILE_PATH
            FROM 
                TB_DP_LIST_PROD LP,
                TB_DP_PROD DP,
                TB_DP_TENANT_PROD_PRICE PR,
                TB_DP_MENU_CATEGORY_PROD_MAPG MP, 
                TB_DP_APP_PROD AP,
                TB_DP_TENANT_PROD TP, 
                TB_DP_PROD_DESC PS,
                TB_DP_SUB_CONTENTS SC,
                TB_DP_PROD_IMG PI,
                TB_DP_SPRT_DEVICE DV,
                TB_DP_MENU_CATEGORY MN
            WHERE LP.LIST_ID = 'ADM000000013'
            AND DP.PROD_ID = LP.PROD_ID
            AND DP.PROD_ID = PR.PROD_ID
            AND MP.PROD_ID = DP.PROD_ID
            AND DP.PROD_ID = AP.PROD_ID
            AND DP.PROD_ID = TP.PROD_ID
            AND DP.PROD_ID = PS.PROD_ID
            AND DP.PROD_ID = SC.PROD_ID
            AND DP.PROD_ID = PI.PROD_ID
            AND SC.SUB_CONTENTS_ID = DV.SUB_CONTENTS_ID 
            AND SC.PROD_ID = DV.PROD_ID 
            AND MN.MENU_ID = MP.MENU_ID
            AND PI.IMG_CD = 'DP000101'
            AND DV.DEVICE_MODEL_CD = 'SCH-W940'
            AND ROWNUM <![CDATA[<=]]> #{count}
        ) PROD LEFT OUTER JOIN TB_DP_TENANT_PROD_STATS ST
        ON PROD.PROD_ID = ST.PROD_ID
        AND PROD.TENANT_ID = ST.TENANT_ID
    </select>
    
    <!--운영자 추천 만화/이북 리스트 조회-->
    <select id="selectCategoryEpubRecomList" parameterType="FeatureCategoryEpubSacReq" resultType="ProductBasicInfo">
        SELECT /* FeatureCategoryMapper.xml, selectCategoryEpubRecomList, SAC : 조준일 , 2014-02-10 */
               B.TENANT_ID
             , B.MENU_ID
             , B.PROD_ID
             , B.TOP_MENU_ID
             , B.META_CLSF_CD
             , 'PD002501' AS CONTENTS_TYPE_CD
             , B.TOTAL_COUNT
          FROM (SELECT A.*
                     , COUNT(*) OVER () AS TOTAL_COUNT
                     , ROW_NUMBER() OVER(ORDER BY EXPO_ORD_ALWAYS_YN DESC, EXPO_ORD, EXPO_ORD_SUB) AS RNUM
                  FROM (SELECT A.TENANT_ID
                             , E.MENU_ID
                             , C.PROD_ID
                             , E.TOP_MENU_ID
                             , F.META_CLSF_CD
                             , B.EXPO_ORD_ALWAYS_YN
                             , B.EXPO_ORD
                             , B.EXPO_ORD_SUB
                             , ROW_NUMBER() OVER(PARTITION BY C.PROD_ID ORDER BY F.UPD_DT DESC) AS RN
                          FROM TB_DP_LIST A
                             , TB_DP_LIST_PROD B
                             , TB_DP_PROD_RSHP C
                             , TB_DP_MENU_CATEGORY_PROD_MAPG D
                             , TB_DP_MENU_CATEGORY E
                             , TB_DP_PROD F  /* 에피소드 */
                             , TB_DP_TENANT_PROD G
                             , (SELECT SD.PROD_ID
                                 FROM TB_DP_SPRT_DEVICE SD
                                     , TB_CM_DEVICE CD
                                 WHERE SD.DEVICE_MODEL_CD = CD.DEVICE_MODEL_CD
                                   AND (SD.DEVICE_MODEL_CD = #{deviceModelCd} OR SD.DEVICE_MODEL_CD = 'android_standard2')
                                   AND CD.USE_YN = 'Y'
                                   <if test='topMenuId == "DP13"'>
                                   AND CD.EBOOK_SPRT_YN = 'Y'
                                   </if>
                                   <if test='topMenuId == "DP14"'>
                                   AND CD.COMIC_SPRT_YN = 'Y'
                                   </if>
                               ) H
                         WHERE A.LIST_ID = B.LIST_ID
                           AND A.TENANT_ID = B.TENANT_ID
                           AND A.EXPO_YN = 'Y'
                           AND B.EXPO_YN = 'Y'
                           AND A.TENANT_ID = #{tenantId}
                           AND A.LIST_ID = #{listId}
                           AND SYSDATE BETWEEN B.EXPO_START_DT AND B.EXPO_END_DT
                           AND TO_CHAR(B.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
                           AND B.PROD_ID = C.PROD_ID  /* 채널 */
                           AND C.PROD_RSHP_CD = 'DP010802'
                           AND B.PROD_ID = D.PROD_ID
                           AND D.USE_YN = 'Y'
                           AND D.MENU_ID = E.MENU_ID
                           AND E.USE_YN = 'Y'
                           AND E.TOP_MENU_ID = #{topMenuId}
                           AND C.PART_PROD_ID = F.PROD_ID
                           AND F.CONTENTS_TYPE_CD = 'PD002502'
                           <if test='prodCharge == "Y"'>
                           AND F.PROD_CHRG_YN = 'Y'  /* 유료 */
                           </if>
                           <if test='prodCharge == "N"'>
                           AND F.PROD_CHRG_YN = 'N'  /* 무료 */
                           </if>
                           <if test='prodGradeCd != null and prodGradeCd != ""'>
                           AND F.PROD_GRD_CD IN
                              <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
                              #{prodGradeCd}          
                              </foreach> /* 상품등급코드 */
                           </if>
                           <if test='topMenuId == "DP13"'>
                           AND F.META_CLSF_CD IN ('CT19', 'CT20')  /* EBOOK */
                               <if test='filteredBy == "ebook+normal"'>  /* 이북 일반 */
                           AND E.MENU_ID NOT IN (SELECT MENU_ID
                                                   FROM TB_DP_MENU_CATEGORY
                                                  WHERE (MENU_ID LIKE 'DP13004%'
                                                         OR MENU_ID  IN ('DP13027002', 'DP13027008', 'DP13027009', 'DP13027010' )
                                                        )
                                                 )
                               </if>
                               <if test='filteredBy == "ebook+gener"'>  /* 이북 장르 */
                           AND E.MENU_ID IN (SELECT MENU_ID
                                               FROM TB_DP_MENU_CATEGORY
                                              WHERE (MENU_ID LIKE 'DP13004%'
                                                     OR MENU_ID  IN ('DP13027002', 'DP13027008', 'DP13027009', 'DP13027010' )
                                                     )
                                            )  
                               </if>
                           </if>
                           AND F.PROD_ID = G.PROD_ID
                           AND B.TENANT_ID = G.TENANT_ID
                           AND G.EXPO_YN = 'Y'
                           AND C.PART_PROD_ID = H.PROD_ID
                      ) A
                 WHERE RN = 1
              ) B
         WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
         ORDER BY RNUM
    </select>
    
    <!-- 코믹/이북 인기만화/도서 리스트 조회-->
    <select id="selectCategoryEpubBestList" parameterType="FeatureCategoryEpubSacReq" resultType="ProductBasicInfo">
        SELECT /* eatureCategoryMapper.xml, selectCategoryEpubBestList, SAC : 조준일 , 2014-02-10 */
	           A.TENANT_ID
	         , A.MENU_ID
	         , A.PROD_ID
	         , A.PART_PROD_ID
	         , A.TOP_MENU_ID
	         , A.CONTENTS_TYPE_CD
	         , A.TOTAL_COUNT
	      FROM (SELECT A.TENANT_ID
		             , D.MENU_ID
		             , H.PROD_ID
		             , H.PART_PROD_ID
		             , D.TOP_MENU_ID
		             , E.CONTENTS_TYPE_CD
		             , COUNT(*) OVER () AS TOTAL_COUNT
		             , ROW_NUMBER() OVER(ORDER BY B.EXPO_ORD_ALWAYS_YN DESC, B.EXPO_ORD, B.EXPO_ORD_SUB) AS RNUM
		          FROM TB_DP_LIST A
		             , TB_DP_LIST_PROD B
		             , TB_DP_MENU_CATEGORY_PROD_MAPG C
		             , TB_DP_MENU_CATEGORY D
		             , TB_DP_PROD E
		             , TB_DP_TENANT_PROD F
		             , (SELECT SD.PROD_ID
		                  FROM TB_DP_SPRT_DEVICE SD
		                     , TB_CM_DEVICE CD
		                 WHERE SD.DEVICE_MODEL_CD = CD.DEVICE_MODEL_CD
		                   AND (SD.DEVICE_MODEL_CD = #{deviceModelCd} OR SD.DEVICE_MODEL_CD = 'android_standard2')
		                   AND CD.USE_YN = 'Y'
		                   <if test='topMenuId == "DP13"'>
		                   AND CD.EBOOK_SPRT_YN = 'Y'
		                   </if>
		                   <if test='topMenuId == "DP14"'>
		                   AND CD.COMIC_SPRT_YN = 'Y'
		                   </if>
		               ) G
                     , TB_DP_PROD_RSHP H
		         WHERE A.LIST_ID = B.LIST_ID
		           AND A.TENANT_ID = B.TENANT_ID
		           AND A.EXPO_YN = 'Y'
		           AND B.EXPO_YN = 'Y'
		           AND SYSDATE BETWEEN B.EXPO_START_DT AND B.EXPO_END_DT
		           AND A.TENANT_ID = #{tenantId}
		           AND A.LIST_ID = #{listId}
		           AND TO_CHAR(B.STD_DT, 'YYYYMMDDHH24MISS') = #{stdDt}
		           AND B.PROD_ID = C.PROD_ID
		           AND B.MENU_ID = C.MENU_ID
		           AND C.USE_YN = 'Y'
		           AND C.MENU_ID = D.MENU_ID
		           AND D.USE_YN = 'Y'
		           AND D.TOP_MENU_ID = #{topMenuId}
                   <if test='menuId != null and menuId != ""'>
                   AND D.MENU_ID = #{menuId}
                   </if>
		           AND C.PROD_ID = E.PROD_ID
		           AND E.CONTENTS_TYPE_CD = 'PD002502'
		           <if test='prodCharge == "Y"'>
		           AND E.PROD_CHRG_YN = 'Y'  /* 유료 */
		           </if>
		           <if test='prodCharge == "N"'>
		           AND E.PROD_CHRG_YN = 'N'  /* 무료 */
		           </if>
		           <if test='prodGradeCd != null and prodGradeCd != ""'>
		           AND E.PROD_GRD_CD IN
		               <foreach collection="prodGradeCdArr" item="prodGradeCd" index="index" open="(" close=")" separator=",">
		           #{prodGradeCd}          
		               </foreach> /* 상품등급코드 */
		           </if>
		           <if test='topMenuId == "DP13"'>
		           AND E.META_CLSF_CD IN ('CT19', 'CT20')  /* EBOOK */
		           </if>         
		           AND E.PROD_ID = F.PROD_ID
		           AND F.EXPO_YN = 'Y'
		           AND B.TENANT_ID = F.TENANT_ID
		           AND F.PROD_ID = G.PROD_ID
		           AND G.PROD_ID = H.PART_PROD_ID
		           AND H.PROD_RSHP_CD = 'DP010802'
		       ) A
         WHERE RNUM BETWEEN #{offset} AND (#{offset}+#{count}-1)
         ORDER BY RNUM
    </select>
    
</mapper>