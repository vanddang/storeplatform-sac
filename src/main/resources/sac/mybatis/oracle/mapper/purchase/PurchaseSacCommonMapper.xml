<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="PurchaseSacCommon">

    <!-- 구매Part 테넌트 정책 목록 조회 -->
    <select id="searchPurchaseTenantPolicyList" parameterType="PurchaseTenantPolicy" resultType="PurchaseTenantPolicy">
        SELECT /* PurchaseSacCommonMapper.searchPurchaseTenantPolicyList, 구매Part 테넌트 정책 목록 조회, 이승택/nTels, 2014-01-22 */
                tenant_id
              , policy_id
              , policy_seq
              , policy_nm
              , proc_pattern_cd
              , tenant_prod_grp_cd
              , apply_unit_cd
              , apply_value
              , cond_unit_cd
              , cond_value
              , cond_period_unit_cd
              , cond_period_value
              , cond_clsf_unit_cd
              , cond_clsf_value
              , policy_prior
          FROM  tb_cm_tenant_sale_policy 
         WHERE  tenant_id = #{tenantId}
         <if test="@com.skplanet.storeplatform.framework.core.util.StringUtils@isNotBlank(procPatternCd)">
           AND  proc_pattern_cd = #{procPatternCd}
         </if>
         <if test="ignoreTenantProdGrpCd == null or ignoreTenantProdGrpCd != true">
           AND  (tenant_prod_grp_cd IS NULL OR #{tenantProdGrpCd, jdbcType=VARCHAR} LIKE CONCAT(tenant_prod_grp_cd, '%'))
         </if>
           AND  SYSDATE BETWEEN start_dt AND expr_dt
      ORDER BY  policy_id, policy_prior, policy_seq
    </select>
    
    <!-- Pay Planet 가맹점 정보 조회 -->
    <select id="searchPayPlanetShopInfoDetail" parameterType="java.lang.String" resultType="PayPlanetShop">
        SELECT /* PurchaseSacCommonMapper.searchPayPlanetShopInfoDetail, Pay Planet 가맹점 정보 조회, 이승택/nTels, 2014-03-25 */
                cd_nm AS mid
              , add_field_01 AS authKey
              , add_field_02 AS encKey
              , cd_desc AS paymentUrl
          FROM  tb_cm_cd
         WHERE  cd_id = #{cd_id}
           AND  use_yn = 'Y'
    </select>
    
</mapper>