<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CardInfo">

	<select id="getCardInfo" parameterType="map" resultType="com.skplanet.storeplatform.sac.display.cache.vo.CardInfo">
		SELECT /* CardInfoMapper.xml, getCardInfo, SAC : 양해엽 , 2014-10-10 */
			CRD.TENANT_ID 
			,CRD.CARD_ID
			,CRD.CARD_TYPE_CD
			,CRD.CARD_TITLE
			,CRD.CARD_DESC
			,CRD.CARD_LAYOUT
			,CRD.LND_TITLE
			,CRD.LND_DESC
			,CRD.LND_LAYOUT	
			,CRD.DATASET_ID
			,CRD.INJT_VAR AS CARD_INJT_VAR
			,CRD.SEGM_TYPE_CD
			,CRD.CARD_IMG_PATH
			,CRD.CARD_IMG_RATIO
			,CRD.CARD_IMG_TYPE
			,CRD.LND_IMG_PATH
			,CRD.LND_IMG_RATIO	
			,CRD.MENU_ID	
			,CRD.SMART_OFR_LIST_ID			
			,(	SELECT NVL2(CD_DESC, CD_DESC||'/'||TO_CHAR(SYSDATE, 'YYYYMMDDHH24'), '')
				FROM TB_CM_CD 
				WHERE CD_ID = 'DP0124' || #{tenantId})  AS SHARE_URL			
			,NVL(CEA.EXPO_YN_CARD_TITLE, 'N') 			AS EXPO_YN_CARD_TITLE
			,NVL(CEA.EXPO_YN_CARD_DESC, 'N') 			AS EXPO_YN_CARD_DESC
			,NVL(CEA.EXPO_YN_CARD_LIKE, 'N') 			AS EXPO_YN_CARD_LIKE
			,NVL(CEA.EXPO_YN_CARD_SHAR, 'N') 			AS EXPO_YN_CARD_SHAR
			,NVL(CEA.EXPO_YN_CARD_LND, 'N') 			AS EXPO_YN_CARD_LND
			,NVL(CEA.EXPO_YN_CARD_DC_PRV_PRICE, 'N') 	AS EXPO_YN_CARD_DC_PRV_PRICE
			,NVL(CEA.EXPO_YN_CARD_DC_RATE, 'N') 		AS EXPO_YN_CARD_DC_RATE
			,NVL(CEA.EXPO_YN_CARD_IMG, 'N') 			AS EXPO_YN_CARD_IMG
			,NVL(CEA.EXPO_YN_CARD_ITEM_NO, 'N') 		AS EXPO_YN_CARD_ITEM_NO
			,NVL(CEA.EXPO_YN_CARD_RECOM_REASON, 'N') 	AS EXPO_YN_CARD_RECOM_REASON
			,NVL(CEA.EXPO_YN_CARD_ABSTR_TM, 'N') 		AS EXPO_YN_CARD_ABSTR_TM			
			,NVL(CEA.EXPO_YN_LND_TITLE, 'N') 			AS EXPO_YN_LND_TITLE
			,NVL(CEA.EXPO_YN_LND_DESC, 'N') 			AS EXPO_YN_LND_DESC
			,NVL(CEA.EXPO_YN_LND_ITEM_NO, 'N') 			AS EXPO_YN_LND_ITEM_NO
			,NVL(CEA.EXPO_YN_LND_DC_PRV_PRICE, 'N') 	AS EXPO_YN_LND_DC_PRV_PRICE
			,NVL(CEA.EXPO_YN_LND_DC_RATE, 'N') 			AS EXPO_YN_LND_DC_RATE
			,NVL(CEA.EXPO_YN_LND_IMG, 'N') 				AS EXPO_YN_LND_IMG
			,NVL(CEA.EXPO_YN_LND_IMG_OVERLAY, 'N') 		AS EXPO_YN_LND_IMG_OVERLAY		
			,DSF.DATASET_GRP_CD
			,DSF.TITLE
			,DSF.DATASET_DESC
			,DSF.TENANT_URL
			,DSF.INJT_VAR AS DATASET_INJT_VAR	
			,DSF.ITEM_LND_URL
		FROM TB_DP_CARD 					CRD
			INNER JOIN TB_DP_CARD_ETC_ATTR	CEA
				ON CRD.TENANT_ID = CEA.TENANT_ID AND CRD.CARD_ID = CEA.CARD_ID
			INNER JOIN TB_DP_DATASET_FRAME 	DSF
				ON CRD.TENANT_ID = DSF.TENANT_ID AND CRD.DATASET_ID = DSF.DATASET_ID
		WHERE 	1=1
			AND	CRD.TENANT_ID = #{tenantId}
			AND	CRD.CARD_ID = #{cardId}
	</select>	
	
</mapper>